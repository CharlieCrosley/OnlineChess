{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\charl\\\\Documents\\\\Code\\\\Web Dev\\\\Chess-Online\\\\chessproject\\\\frontend\\\\src\\\\pages\\\\Chess.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from \"react\";\nimport useWebSocket, { ReadyState } from \"react-use-websocket\";\nimport { useLocation } from \"react-router-dom\";\nimport { GameContainer, GamePlayer, Player, TakenPieces } from \"./GameElements\";\nimport Board from \"../components/Board\";\nimport { initBoardState } from \"../components/BoardState\";\nimport { useEffect } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Chess = () => {\n  _s();\n\n  const location = useLocation();\n  const [room, setRoom] = useState(location.state.room);\n  const [name, setName] = useState(location.state.name);\n  const [opponentName, setOpponentName] = useState(\"charlie\");\n  const [playerColour, setColour] = useState(location.state.colour);\n  const [takenPieces, setTakenPieces] = useState({\n    white: [],\n    black: [require(\"../assets/images/pieces/pawn_b.png\"), require(\"../assets/images/pieces/queen_b.png\"), require(\"../assets/images/pieces/bishop_b.png\"), require(\"../assets/images/pieces/king_b.png\")]\n  });\n  const boardRotation = getBoardRotation(playerColour);\n  const isWhite = playerColour === \"white\"; // Sets initial piece positions ensuring that players colour is always at bottom\n\n  const [boardState, setBoardState] = useState(initBoardState(isWhite, boardRotation));\n  const [prevBoardState, setPrevBoardState] = useState(null);\n  const {\n    sendMessage,\n    readyState\n  } = useWebSocket(\"ws://127.0.0.1:8000/ws/\" + room + \"/\", {\n    onOpen: () => {\n      console.log(\"Connected!\");\n      sendMessage(JSON.stringify({\n        type: \"send_message\",\n        message: {\n          opponentName: name\n        },\n        event: \"START\"\n      }));\n    },\n    onClose: () => {\n      console.log(\"Disconnected!\");\n    },\n    onMessage: e => {\n      const dataFromServer = JSON.parse(e.data);\n\n      switch (dataFromServer.payload.event) {\n        case \"START\":\n          if (opponentName === null && dataFromServer.payload.message.opponentName !== name) {\n            //\n            console.log(dataFromServer.payload.message.opponentName);\n            setOpponentName(dataFromServer.payload.message.opponentName);\n            sendMessage(JSON.stringify({\n              type: \"send_message\",\n              message: {\n                opponentName: name\n              },\n              event: \"START\"\n            }));\n          }\n\n        case \"MOVE\":\n          if (dataFromServer.payload.message.opponent.colour !== playerColour) {\n            setBoardState(flipBoard(dataFromServer.payload.message.boardState));\n            setTakenPieces(dataFromServer.payload.message.takenPieces);\n            setOpponentName(dataFromServer.payload.message.opponent.name);\n          }\n\n      }\n    }\n  });\n  const connectionStatus = {\n    [ReadyState.CONNECTING]: \"Connecting\",\n    [ReadyState.OPEN]: \"Open\",\n    [ReadyState.CLOSING]: \"Closing\",\n    [ReadyState.CLOSED]: \"Closed\",\n    [ReadyState.UNINSTANTIATED]: \"Uninstantiated\"\n  }[readyState];\n  useEffect(() => {\n    // Send the current board state to the websocket group\n    // Only send message if the board state has changed to avoid infintite loop of sending\n    //console.log(false);\n    if (JSON.stringify(prevBoardState) !== JSON.stringify(boardState)) {\n      //console.log(true);\n      setPrevBoardState(boardState);\n      sendMessage(JSON.stringify({\n        type: \"send_message\",\n        message: {\n          boardState,\n          takenPieces,\n          opponent: {\n            name: name,\n            colour: playerColour\n          }\n        },\n        event: \"MOVE\"\n      }));\n    }\n  }, [boardState]);\n  const opponentColour = playerColour === \"white\" ? \"black\" : \"white\";\n  return /*#__PURE__*/_jsxDEV(GameContainer, {\n    children: /*#__PURE__*/_jsxDEV(GamePlayer, {\n      children: [/*#__PURE__*/_jsxDEV(Player, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: opponentName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(TakenPieces, {\n          children: takenPieces[playerColour].map((piecePath, i) => {\n            return /*#__PURE__*/_jsxDEV(\"img\", {\n              src: piecePath\n            }, i, false, {\n              fileName: _jsxFileName,\n              lineNumber: 138,\n              columnNumber: 36\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Board, {\n        boardState: boardState,\n        setBoardState: setBoardState,\n        setTakenPieces: setTakenPieces\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Player, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(TakenPieces, {\n          children: takenPieces[opponentColour].map((piecePath, i) => {\n            return /*#__PURE__*/_jsxDEV(\"img\", {\n              src: piecePath\n            }, i, false, {\n              fileName: _jsxFileName,\n              lineNumber: 151,\n              columnNumber: 36\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 129,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Chess, \"7MY1xfkaNwpAjphmX0Kjnnib7eE=\", false, function () {\n  return [useLocation, useWebSocket];\n});\n\n_c = Chess;\nexport default Chess;\n\nconst getBoardRotation = colour => {\n  if (colour === \"white\") return {\n    white: [7, 6],\n    black: [0, 1]\n  };else if (colour === \"black\") return {\n    white: [0, 1],\n    black: [7, 6]\n  };\n  throw \"Colour must be black or white\";\n};\n\nconst flipBoard = boardState => {\n  for (const [_, state] of Object.entries(boardState)) {\n    state.row = 7 - state.row;\n    state.isOwner = !state.isOwner;\n  }\n\n  return boardState;\n};\n/* var roomCode = document.getElementById(\"game_board\").getAttribute(\"room_code\");\r\nvar char_choice = document\r\n    .getElementById(\"game_board\")\r\n    .getAttribute(\"char_choice\");\r\n\r\nvar connectionString =\r\n    \"ws://\" + window.location.host + \"/ws/play/\" + roomCode + \"/\";\r\nvar gameSocket = new WebSocket(connectionString);\r\n\r\nlet myturn = true;\r\n\r\nfunction make_move(index, player) {\r\n    index = parseInt(index);\r\n    let data = {\r\n        event: \"MOVE\",\r\n        message: {\r\n            index: index,\r\n            player: player,\r\n        },\r\n    };\r\n\r\n    if (gameBoard[index] == -1) {\r\n        moveCount++;\r\n        if (player == \"X\") gameBoard[index] = 1;\r\n        else if (player == \"O\") gameBoard[index] = 0;\r\n        else {\r\n            alert(\"Invalid character choice\");\r\n            return false;\r\n        }\r\n        gameSocket.send(JSON.stringify(data));\r\n    }\r\n\r\n    elementArray[index].innerHTML = player;\r\n    const win = checkWinner();\r\n    if (myturn) {\r\n        if (win) {\r\n            data = {\r\n                event: \"END\",\r\n                message: `${player} is a winner. Play again?`,\r\n            };\r\n            gameSocket.send(JSON.stringify(data));\r\n        } else if (!win && moveCount == 9) {\r\n            data = {\r\n                event: \"END\",\r\n                message: \"It's a draw. Play again?\",\r\n            };\r\n            gameSocket.send(JSON.stringify(data));\r\n        }\r\n    }\r\n}\r\n\r\nfunction connect() {\r\n    gameSocket.onopen = function open() {\r\n        console.log(\"WebSockets connection created.\");\r\n        gameSocket.send(\r\n            JSON.stringify({\r\n                event: \"START\",\r\n                message: \"\",\r\n            })\r\n        );\r\n    };\r\n\r\n    gameSocket.onclose = function (e) {\r\n        console.log(\r\n            \"Socket is closed. Reconnect will be attempted in 1 second.\",\r\n            e.reason\r\n        );\r\n        setTimeout(function () {\r\n            connect();\r\n        }, 1000);\r\n    };\r\n    // Sending the info about the room\r\n    gameSocket.onmessage = function (e) {\r\n        let data = JSON.parse(e.data);\r\n        data = data[\"payload\"];\r\n        let message = data[\"message\"];\r\n        let event = data[\"event\"];\r\n        switch (event) {\r\n            case \"START\":\r\n                //reset();\r\n                break;\r\n            case \"END\":\r\n                alert(message);\r\n                //reset();\r\n                break;\r\n            case \"MOVE\":\r\n                if (message[\"player\"] != char_choice) {\r\n                    make_move(message[\"index\"], message[\"player\"]);\r\n                    myturn = true;\r\n                    document.getElementById(\"alert_move\").style.display =\r\n                        \"inline\";\r\n                }\r\n                break;\r\n            default:\r\n                console.log(\"No event\");\r\n        }\r\n    };\r\n\r\n    if (gameSocket.readyState == WebSocket.OPEN) {\r\n        gameSocket.onopen();\r\n    }\r\n}\r\n\r\nconnect(); */\n\n\nvar _c;\n\n$RefreshReg$(_c, \"Chess\");","map":{"version":3,"names":["React","useState","useWebSocket","ReadyState","useLocation","GameContainer","GamePlayer","Player","TakenPieces","Board","initBoardState","useEffect","Chess","location","room","setRoom","state","name","setName","opponentName","setOpponentName","playerColour","setColour","colour","takenPieces","setTakenPieces","white","black","require","boardRotation","getBoardRotation","isWhite","boardState","setBoardState","prevBoardState","setPrevBoardState","sendMessage","readyState","onOpen","console","log","JSON","stringify","type","message","event","onClose","onMessage","e","dataFromServer","parse","data","payload","opponent","flipBoard","connectionStatus","CONNECTING","OPEN","CLOSING","CLOSED","UNINSTANTIATED","opponentColour","map","piecePath","i","_","Object","entries","row","isOwner"],"sources":["C:/Users/charl/Documents/Code/Web Dev/Chess-Online/chessproject/frontend/src/pages/Chess.js"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport useWebSocket, { ReadyState } from \"react-use-websocket\";\r\nimport { useLocation } from \"react-router-dom\";\r\nimport { GameContainer, GamePlayer, Player, TakenPieces } from \"./GameElements\";\r\nimport Board from \"../components/Board\";\r\nimport { initBoardState } from \"../components/BoardState\";\r\nimport { useEffect } from \"react\";\r\n\r\nconst Chess = () => {\r\n    const location = useLocation();\r\n\r\n    const [room, setRoom] = useState(location.state.room);\r\n    const [name, setName] = useState(location.state.name);\r\n    const [opponentName, setOpponentName] = useState(\"charlie\");\r\n    const [playerColour, setColour] = useState(location.state.colour);\r\n    const [takenPieces, setTakenPieces] = useState({\r\n        white: [],\r\n        black: [\r\n            require(\"../assets/images/pieces/pawn_b.png\"),\r\n            require(\"../assets/images/pieces/queen_b.png\"),\r\n            require(\"../assets/images/pieces/bishop_b.png\"),\r\n            require(\"../assets/images/pieces/king_b.png\"),\r\n        ],\r\n    });\r\n\r\n    const boardRotation = getBoardRotation(playerColour);\r\n    const isWhite = playerColour === \"white\";\r\n    // Sets initial piece positions ensuring that players colour is always at bottom\r\n    const [boardState, setBoardState] = useState(\r\n        initBoardState(isWhite, boardRotation)\r\n    );\r\n    const [prevBoardState, setPrevBoardState] = useState(null);\r\n\r\n    const { sendMessage, readyState } = useWebSocket(\r\n        \"ws://127.0.0.1:8000/ws/\" + room + \"/\",\r\n        {\r\n            onOpen: () => {\r\n                console.log(\"Connected!\");\r\n                sendMessage(\r\n                    JSON.stringify({\r\n                        type: \"send_message\",\r\n                        message: { opponentName: name },\r\n                        event: \"START\",\r\n                    })\r\n                );\r\n            },\r\n            onClose: () => {\r\n                console.log(\"Disconnected!\");\r\n            },\r\n            onMessage: (e) => {\r\n                const dataFromServer = JSON.parse(e.data);\r\n                switch (dataFromServer.payload.event) {\r\n                    case \"START\":\r\n                        if (\r\n                            opponentName === null &&\r\n                            dataFromServer.payload.message.opponentName !== name\r\n                        ) {\r\n                            //\r\n                            console.log(\r\n                                dataFromServer.payload.message.opponentName\r\n                            );\r\n                            setOpponentName(\r\n                                dataFromServer.payload.message.opponentName\r\n                            );\r\n                            sendMessage(\r\n                                JSON.stringify({\r\n                                    type: \"send_message\",\r\n                                    message: { opponentName: name },\r\n                                    event: \"START\",\r\n                                })\r\n                            );\r\n                        }\r\n\r\n                    case \"MOVE\":\r\n                        if (\r\n                            dataFromServer.payload.message.opponent.colour !==\r\n                            playerColour\r\n                        ) {\r\n                            setBoardState(\r\n                                flipBoard(\r\n                                    dataFromServer.payload.message.boardState\r\n                                )\r\n                            );\r\n\r\n                            setTakenPieces(\r\n                                dataFromServer.payload.message.takenPieces\r\n                            );\r\n                            setOpponentName(\r\n                                dataFromServer.payload.message.opponent.name\r\n                            );\r\n                        }\r\n                }\r\n            },\r\n        }\r\n    );\r\n\r\n    const connectionStatus = {\r\n        [ReadyState.CONNECTING]: \"Connecting\",\r\n        [ReadyState.OPEN]: \"Open\",\r\n        [ReadyState.CLOSING]: \"Closing\",\r\n        [ReadyState.CLOSED]: \"Closed\",\r\n        [ReadyState.UNINSTANTIATED]: \"Uninstantiated\",\r\n    }[readyState];\r\n\r\n    useEffect(() => {\r\n        // Send the current board state to the websocket group\r\n        // Only send message if the board state has changed to avoid infintite loop of sending\r\n        //console.log(false);\r\n        if (JSON.stringify(prevBoardState) !== JSON.stringify(boardState)) {\r\n            //console.log(true);\r\n            setPrevBoardState(boardState);\r\n            sendMessage(\r\n                JSON.stringify({\r\n                    type: \"send_message\",\r\n                    message: {\r\n                        boardState,\r\n                        takenPieces,\r\n                        opponent: { name: name, colour: playerColour },\r\n                    },\r\n                    event: \"MOVE\",\r\n                })\r\n            );\r\n        }\r\n    }, [boardState]);\r\n\r\n    const opponentColour = playerColour === \"white\" ? \"black\" : \"white\";\r\n\r\n    return (\r\n        <GameContainer>\r\n            <GamePlayer>\r\n                {/* <div style={{ color: \"white\" }}>\r\n                    The WebSocket is currently {connectionStatus}\r\n                </div> */}\r\n                <Player>\r\n                    <div>{opponentName}</div>\r\n                    <TakenPieces>\r\n                        {takenPieces[playerColour].map((piecePath, i) => {\r\n                            return <img key={i} src={piecePath} />;\r\n                        })}\r\n                    </TakenPieces>\r\n                </Player>\r\n                <Board\r\n                    boardState={boardState}\r\n                    setBoardState={setBoardState}\r\n                    setTakenPieces={setTakenPieces}\r\n                />\r\n                <Player>\r\n                    <div>{name}</div>\r\n                    <TakenPieces>\r\n                        {takenPieces[opponentColour].map((piecePath, i) => {\r\n                            return <img key={i} src={piecePath} />;\r\n                        })}\r\n                    </TakenPieces>\r\n                </Player>\r\n            </GamePlayer>\r\n        </GameContainer>\r\n    );\r\n};\r\n\r\nexport default Chess;\r\n\r\nconst getBoardRotation = (colour) => {\r\n    if (colour === \"white\") return { white: [7, 6], black: [0, 1] };\r\n    else if (colour === \"black\") return { white: [0, 1], black: [7, 6] };\r\n    throw \"Colour must be black or white\";\r\n};\r\n\r\nconst flipBoard = (boardState) => {\r\n    for (const [_, state] of Object.entries(boardState)) {\r\n        state.row = 7 - state.row;\r\n        state.isOwner = !state.isOwner;\r\n    }\r\n    return boardState;\r\n};\r\n\r\n/* var roomCode = document.getElementById(\"game_board\").getAttribute(\"room_code\");\r\nvar char_choice = document\r\n    .getElementById(\"game_board\")\r\n    .getAttribute(\"char_choice\");\r\n\r\nvar connectionString =\r\n    \"ws://\" + window.location.host + \"/ws/play/\" + roomCode + \"/\";\r\nvar gameSocket = new WebSocket(connectionString);\r\n\r\nlet myturn = true;\r\n\r\nfunction make_move(index, player) {\r\n    index = parseInt(index);\r\n    let data = {\r\n        event: \"MOVE\",\r\n        message: {\r\n            index: index,\r\n            player: player,\r\n        },\r\n    };\r\n\r\n    if (gameBoard[index] == -1) {\r\n        moveCount++;\r\n        if (player == \"X\") gameBoard[index] = 1;\r\n        else if (player == \"O\") gameBoard[index] = 0;\r\n        else {\r\n            alert(\"Invalid character choice\");\r\n            return false;\r\n        }\r\n        gameSocket.send(JSON.stringify(data));\r\n    }\r\n\r\n    elementArray[index].innerHTML = player;\r\n    const win = checkWinner();\r\n    if (myturn) {\r\n        if (win) {\r\n            data = {\r\n                event: \"END\",\r\n                message: `${player} is a winner. Play again?`,\r\n            };\r\n            gameSocket.send(JSON.stringify(data));\r\n        } else if (!win && moveCount == 9) {\r\n            data = {\r\n                event: \"END\",\r\n                message: \"It's a draw. Play again?\",\r\n            };\r\n            gameSocket.send(JSON.stringify(data));\r\n        }\r\n    }\r\n}\r\n\r\nfunction connect() {\r\n    gameSocket.onopen = function open() {\r\n        console.log(\"WebSockets connection created.\");\r\n        gameSocket.send(\r\n            JSON.stringify({\r\n                event: \"START\",\r\n                message: \"\",\r\n            })\r\n        );\r\n    };\r\n\r\n    gameSocket.onclose = function (e) {\r\n        console.log(\r\n            \"Socket is closed. Reconnect will be attempted in 1 second.\",\r\n            e.reason\r\n        );\r\n        setTimeout(function () {\r\n            connect();\r\n        }, 1000);\r\n    };\r\n    // Sending the info about the room\r\n    gameSocket.onmessage = function (e) {\r\n        let data = JSON.parse(e.data);\r\n        data = data[\"payload\"];\r\n        let message = data[\"message\"];\r\n        let event = data[\"event\"];\r\n        switch (event) {\r\n            case \"START\":\r\n                //reset();\r\n                break;\r\n            case \"END\":\r\n                alert(message);\r\n                //reset();\r\n                break;\r\n            case \"MOVE\":\r\n                if (message[\"player\"] != char_choice) {\r\n                    make_move(message[\"index\"], message[\"player\"]);\r\n                    myturn = true;\r\n                    document.getElementById(\"alert_move\").style.display =\r\n                        \"inline\";\r\n                }\r\n                break;\r\n            default:\r\n                console.log(\"No event\");\r\n        }\r\n    };\r\n\r\n    if (gameSocket.readyState == WebSocket.OPEN) {\r\n        gameSocket.onopen();\r\n    }\r\n}\r\n\r\nconnect(); */\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}